---
import BlogPostLayout from "../../../layouts/BlogPostLayout.astro";
import RadiographyHeader from "../../../components/blog/RadiographyHeader.astro";
import RadiographyLegend from "../../../components/blog/RadiographyLegend.astro";
import PostFooterBar from "../../../components/blog/PostFooterBar.astro";

const title = "Lex (.l) Anatomy";
const description = "Radiography of a Flex/Lex file: The heart of token analysis";
---

<BlogPostLayout
  title={title}
  description={description}
  bgColor="bg-slate-950"
  extraFonts="&family=Fira+Code:wght@400;700"
  lang="en"
>
  <div class="relative p-8 md:p-12 flex flex-col text-white overflow-hidden h-full">
    <div class="absolute top-4 right-4 z-50">
      <a href="/es/posts/compiler-lex-anatomy" class="glass-tag px-3 py-1 rounded text-slate-400 hover:text-white text-sm font-bold transition-colors">ES</a>
    </div>

    <RadiographyHeader
      categoryText="Compilers"
      categoryColorClass="text-orange-400"
      titlePrefix="X-Ray:"
      titleHighlightText="Flex / Lex"
      titleHighlightColorClass="highlight-orange"
      subtitle="Lexical Analyzer (.l)"
    />

    <div class="feature-card rounded-3xl p-6 md:p-8 mb-6 relative flex flex-col md:flex-row gap-8 items-stretch">
      <div class="code-font text-xs leading-relaxed flex-1 border-r border-white/10 pr-6 overflow-x-auto">
        <p class="text-slate-500 italic">%{"{"} // C-Code Declarations %{"}"}</p>
        <p class="text-blue-400">DIGIT [0-9]</p>
        <p class="text-blue-400">ID [a-z]+</p>
        <p class="text-slate-500 italic">%% // Rules Section</p>
        <p class="bg-orange-500/10 rounded px-1">
          {"{"}DIGIT{"}"}+ {"{"} yylval = atoi(yytext); return NUM; {"}"}
        </p>
        <p class="bg-orange-500/10 rounded px-1 mt-1">
          "+" {"{"} return '+'; {"}"}
        </p>
        <p class="text-slate-500 italic">%% // User Code</p>
        <p class="text-emerald-400">int main() {"{"} yylex(); {"}"}</p>
      </div>

      <RadiographyLegend
        items={[
          {
            bgColor: "bg-blue-500",
            shadowRgba: "rgba(59,130,246,0.5)",
            textColor: "text-blue-400",
            title: "Definitions",
            description: "Regex Aliases <br>(e.g. DIGIT = [0-9]).",
          },
          {
            bgColor: "bg-orange-500",
            shadowRgba: "rgba(249,115,22,0.5)",
            textColor: "text-orange-400",
            title: "Rules & Actions",
            description: "If text matches, <br>executes C code.",
          },
          {
            bgColor: "bg-emerald-500",
            shadowRgba: "rgba(16,185,129,0.5)",
            textColor: "text-emerald-400",
            title: "Value Passing",
            description: "Uses yylval to send <br>data to Parser.",
          },
        ]}
        gap="gap-6"
        minWidth="min-w-[240px]"
      />
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 items-start mb-auto">
      <div class="glass-tag p-5 rounded-xl border-l-4 border-orange-500">
        <h4 class="text-orange-400 font-bold text-lg uppercase tracking-widest mb-1">Lexical Flow</h4>
        <p class="text-slate-200 leading-snug text-sm">
          Lex reads the character stream and splits it into <span class="text-white font-bold">Lexemes</span>. Each lexema is classified into a <span class="text-white font-bold">Token</span> that Bison can understand.
        </p>
      </div>
      <div class="grid grid-cols-2 gap-4">
        <div class="feature-card p-4 rounded-xl">
          <h3 class="text-orange-400 font-bold text-sm mb-1">yytext</h3>
          <p class="text-slate-400 text-[10px]">Contains the exact text that matched the rule.</p>
        </div>
        <div class="feature-card p-4 rounded-xl">
          <h3 class="text-orange-400 font-bold text-sm mb-1">yylex()</h3>
          <p class="text-slate-400 text-[10px]">Main function that starts the scan.</p>
        </div>
      </div>
    </div>

    <PostFooterBar
      middleHtml='<span class="text-orange-400 font-black italic">LEXEMES</span> in â€¢ <span class="text-blue-400 font-black italic">TOKENS</span> out.'
    />
  </div>

  <style>
    .feature-card { background: rgba(249, 115, 22, 0.03); border: 1px solid rgba(249, 115, 22, 0.1); }
    .glass-tag { background: rgba(249, 115, 22, 0.05); border: 1px solid rgba(249, 115, 22, 0.2); }
    .highlight-orange { color: #f97316; }
  </style>
</BlogPostLayout>
