---
import { db, MyCertificates, asc, eq } from "astro:db";
import BaseLayout from "../../../layouts/BaseLayout.astro";
import CertificatesCard from "../../../components/certificates/CertificatesCard.astro";

// --- CERTIFICATES PAGE METADATA ---
const pageTitle = "All My Certificates - Christopher Villamarín";
const pageDescription =
    "Explore all web development certificates and achievements by Christopher Villamarín. Includes certifications from Alura Latam, Oracle ONE, Microsoft, and more.";
const pageKeywords = [
    "development certificates",
    "web certifications",
    "Alura Latam",
    "Oracle ONE",
    "Microsoft",
    "programming skills",
    "web developer",
    "Christopher Villamarín",
    "xeland314",
].join(", ");

const pageAuthor = "Christopher Villamarín";
const applicationName = "Christopher Villamarín Portfolio";
const pageUrl = "https://xeland314.github.io/en/certificates";
const pageImage = "https://xeland314.github.io/images/gato.svg";
const pageImageAlt =
    "Illustration of various programming and development certificates";
const pageRobots = "index, follow";
const pageCanonical = pageUrl;

// Get all certificates from the DB for English language
const allCertificates = await db
    .select()
    .from(MyCertificates)
    .where(eq(MyCertificates.lang, "en"))
    .orderBy(
        asc(MyCertificates.date),
        MyCertificates.isFeatured,
        MyCertificates.title,
    );
---

<BaseLayout
    title={pageTitle}
    description={pageDescription}
    keywords={pageKeywords}
    author={pageAuthor}
    applicationName={applicationName}
    url={pageUrl}
    image={pageImage}
    imageAlt={pageImageAlt}
    robots={pageRobots}
    canonical={pageCanonical}
    lang="en"
>
    <main
        class="py-8 bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-white min-h-screen"
    >
        <section class="max-w-[1500px] mx-auto px-6">
            <h1
                class="text-5xl font-extrabold text-center mb-6"
                transition:name="My-Certificates"
            >
                All My Certificates
            </h1>
            {
                allCertificates.length > 0 ? (
                    <CertificatesCard
                        certificates={allCertificates}
                        lang="en"
                    />
                ) : (
                    <p class="text-center text-gray-500">
                        No certificates found.
                    </p>
                )
            }
        </section>
    </main>
</BaseLayout>
