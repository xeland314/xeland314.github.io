---
import BaseLayout from "./BaseLayout.astro";

interface Props {
  // Metadatos SEO
  metaTitle: string;
  metaDescription: string;
  lang?: string;

  // Props visuales del Cover
  title: string;
  subtitle: string;
  category: string;
  themeColor: "blue" | "purple" | "emerald" | "orange" | "rose" | "yellow" | "sky";
  iconChar?: string;
}

const {
  metaTitle,
  metaDescription,
  lang = "es",
  title,
  subtitle,
  category,
  themeColor = "blue",
  iconChar = "游",
} = Astro.props;

const colors = {
  blue: {
    gradient: "from-blue-600 to-cyan-400",
    textAccent: "text-blue-400",
    bg: "bg-blue-500",
    shadow: "shadow-blue-500/20",
  },
  purple: {
    gradient: "from-purple-600 to-pink-500",
    textAccent: "text-purple-400",
    bg: "bg-purple-500",
    shadow: "shadow-purple-500/20",
  },
  emerald: {
    gradient: "from-emerald-600 to-teal-400",
    textAccent: "text-emerald-400",
    bg: "bg-emerald-500",
    shadow: "shadow-emerald-500/20",
  },
  orange: {
    gradient: "from-orange-600 to-amber-400",
    textAccent: "text-orange-400",
    bg: "bg-orange-500",
    shadow: "shadow-orange-500/20",
  },
  rose: {
    gradient: "from-rose-600 to-red-400",
    textAccent: "text-rose-400",
    bg: "bg-rose-500",
    shadow: "shadow-rose-500/20",
  },
  yellow: {
    gradient: "from-yellow-500 to-orange-400",
    textAccent: "text-yellow-400",
    bg: "bg-yellow-500",
    shadow: "shadow-yellow-500/20",
  },
  sky: {
    gradient: "from-sky-600 to-blue-400",
    textAccent: "text-sky-400",
    bg: "bg-sky-500",
    shadow: "shadow-sky-500/20",
  },
};

const c = colors[themeColor] || colors.blue;
---

<BaseLayout
  title={metaTitle}
  description={metaDescription}
  keywords={`${category}, ${title}`}
  author="xeland314"
  applicationName="xeland314 Blog"
  url={Astro.url.href}
  canonical={Astro.url.href}
  image="/assets/images/logo_v3.png"
  lang={lang}
>
  <link
    href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400&display=swap"
    rel="stylesheet"
    slot="head"
  />

  <div class="min-h-screen flex items-center justify-center bg-gray-900 overflow-hidden">
    <!-- Wrapper para controlar el tama침o visual tras el escalado -->
    <div id="scaler-wrapper" class="relative">
      <!-- Canvas container fijo 1080x1080 -->
      <div
        id="canvas-target"
        class="relative overflow-hidden flex flex-col items-center justify-center p-12 bg-slate-900 text-white shadow-2xl origin-top-left"
        style="width: 1080px; height: 1080px; flex-shrink: 0;"
      >
        <!-- Background Ambient Blobs -->
        <div
          class={`absolute top-0 left-0 w-[500px] h-[500px] ${c.bg}/20 rounded-full blur-[150px] -translate-x-1/2 -translate-y-1/2 pointer-events-none`}
        >
        </div>
        <div
          class={`absolute bottom-0 right-0 w-[500px] h-[500px] ${c.bg}/20 rounded-full blur-[150px] translate-x-1/3 translate-y-1/3 pointer-events-none`}
        >
        </div>

        <!-- Pattern Overlay -->
        <div
          class="absolute inset-0 opacity-20 pointer-events-none"
          style="background-image: radial-gradient(#ffffff 1px, transparent 1px); background-size: 40px 40px;"
        >
        </div>

        <!-- Content Container -->
        <div class="relative z-10 flex flex-col items-center text-center">
          <!-- Category Badge -->
          <div
            class="mb-8 px-5 py-2 rounded-full border border-slate-700 bg-slate-800/80 backdrop-blur-md shadow-xl"
          >
            <span
              class={`${c.textAccent} font-bold tracking-[0.3em] uppercase text-2xl font-mono flex items-center gap-2`}
            >
              <span class={`w-2 h-2 rounded-full ${c.bg}`}></span>
              {category}
            </span>
          </div>

          <!-- Main Icon -->
          <div
            class={`mb-10 w-40 h-40 rounded-[2.5rem] glass-panel flex items-center justify-center shadow-2xl ${c.shadow} border-t border-white/10`}
          >
            <span
              class="text-8xl filter drop-shadow-lg transform hover:scale-110 transition-transform duration-500"
            >
              {iconChar}
            </span>
          </div>

          <!-- Titles -->
          <h1
            class={`hero-title text-6xl md:text-8xl font-black text-transparent bg-clip-text bg-gradient-to-br ${c.gradient} mb-6 tracking-tight leading-tight max-w-4xl`}
          >
            {title}
          </h1>

          <div class={`h-1 w-24 ${c.bg} rounded-full mb-8 opacity-80`}></div>

          <h2
            class="text-3xl md:text-4xl font-bold text-slate-300 max-w-3xl leading-snug tracking-tight"
          >
            {subtitle}
          </h2>
        </div>

        <!-- Footer Brand -->
        <div class="absolute bottom-12 flex items-center gap-3">
          <img
            src="/assets/images/logo_v1.jpg"
            alt="xeland314"
            title="xeland314"
            class="w-12 h-12 rounded-lg border border-slate-600"
            width="48"
            height="48"
          />
          <span class="text-slate-500 font-mono text-md tracking-[0.2em] font-bold"
            >XELAND314</span
          >
        </div>
      </div>
    </div>
  </div>
</BaseLayout>

<script>
  function scaleCanvas() {
    const wrapper = document.getElementById("scaler-wrapper");
    const canvas = document.getElementById("canvas-target");
    if (!wrapper || !canvas) return;

    // Obtenemos el ancho de la ventana
    const screenWidth = window.innerWidth;
    const targetWidth = 1080;

    // Solo escalamos si la pantalla es m치s peque침a que 1080px
    if (screenWidth < targetWidth) {
      const scale = screenWidth / targetWidth;
      
      // Aplicamos la transformaci칩n
      canvas.style.transform = `scale(${scale})`;
      
      // Ajustamos el contenedor padre para que ocupe exactamente lo que mide visualmente el canvas escalado
      // Esto elimina el espacio en blanco extra
      wrapper.style.width = `${targetWidth * scale}px`;
      wrapper.style.height = `${1080 * scale}px`;
    } else {
      // Reset en pantallas grandes
      canvas.style.transform = "none";
      wrapper.style.width = "";
      wrapper.style.height = "";
    }
  }

  // Ejecutar al cargar y al redimensionar
  window.addEventListener("resize", scaleCanvas);
  window.addEventListener("DOMContentLoaded", scaleCanvas);
  // Por si acaso astro view transitions est치n activas
  document.addEventListener("astro:page-load", scaleCanvas);
  scaleCanvas();
</script>

<style>
  .hero-title {
    text-shadow: 0 0 40px rgba(0, 0, 0, 0.5);
  }
  .glass-panel {
    background: rgba(255, 255, 255, 0.03);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.05);
  }
</style>
